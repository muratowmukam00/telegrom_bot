#!/bin/bash
# ============================================================================
# ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð¾Ñ‚ Ð½ÐµÐ½ÑƒÐ¶Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
# ============================================================================

set -e

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo -e "${GREEN}ðŸ§¹ ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð¾Ñ‚ Ð½ÐµÐ½ÑƒÐ¶Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²...${NC}\n"

# ============================================================================
# 1. Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ/Ð½ÐµÐ½ÑƒÐ¶Ð½Ñ‹Ðµ Python Ñ„Ð°Ð¹Ð»Ñ‹
# ============================================================================

echo -e "${YELLOW}ðŸ“ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ€Ñ‹Ñ… Python Ñ„Ð°Ð¹Ð»Ð¾Ð²...${NC}"

# Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð·Ð°Ð¿ÑƒÑÐºÐ°
rm -f main.py
rm -f ws_main.py
rm -f ws_main_old.py
rm -f run_hybrid_backup3.py
rm -f test_telegram.py

echo -e "${GREEN}  âœ“ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Python Ñ„Ð°Ð¹Ð»Ñ‹ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹${NC}\n"


# ============================================================================
# 2. Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹
# ============================================================================

echo -e "${YELLOW}ðŸ“ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ€Ñ‹Ñ… ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²...${NC}"

rm -rf scripts/
rm -f setup.sh
rm -f run_tests.sh

echo -e "${GREEN}  âœ“ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹${NC}\n"


# ============================================================================
# 3. Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð¼Ð¾Ð´ÑƒÐ»Ð¸ services
# ============================================================================

echo -e "${YELLOW}ðŸ“ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ð¼Ð¾Ð´ÑƒÐ»ÐµÐ¹...${NC}"

# Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð² services/mexc/
rm -f services/mexc/monitor.py
rm -f services/mexc/ws_monitor.py
rm -f services/mexc/ws_price_manager.py

# Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð² services/analysis/
rm -f services/analysis/price_buffer.py

echo -e "${GREEN}  âœ“ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ð¼Ð¾Ð´ÑƒÐ»Ð¸ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹${NC}\n"


# ============================================================================
# 4. Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ (ÐµÑÐ»Ð¸ Ð½Ðµ Ð½ÑƒÐ¶Ð½Ñ‹ Ñ‚ÐµÑÑ‚Ñ‹)
# ============================================================================

echo -e "${YELLOW}ðŸ“ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð²...${NC}"

rm -rf tests/
rm -rf .pytest_cache/
rm -f .coverage

echo -e "${GREEN}  âœ“ Ð¢ÐµÑÑ‚Ñ‹ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹${NC}\n"


# ============================================================================
# 5. Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸ Ð¸ Ð»Ð¾Ð³Ð¸
# ============================================================================

echo -e "${YELLOW}ðŸ“ ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¾Ð²...${NC}"

# Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸ (Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ)
rm -f charts/*.png
rm -f logs/*.png
rm -f bot/utils/signal_chart.png
rm -rf bot/utils/logs/

echo -e "${GREEN}  âœ“ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹${NC}\n"


# ============================================================================
# 6. ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ __pycache__ Ð¸ .pyc Ñ„Ð°Ð¹Ð»Ñ‹
# ============================================================================

echo -e "${YELLOW}ðŸ“ ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÐºÑÑˆÐ° Python...${NC}"

find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null || true
find . -type f -name "*.pyc" -delete
find . -type f -name "*.pyo" -delete

echo -e "${GREEN}  âœ“ Python ÐºÑÑˆ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½${NC}\n"


# ============================================================================
# 7. Ð£Ð´Ð°Ð»ÑÐµÐ¼ IDE Ñ„Ð°Ð¹Ð»Ñ‹
# ============================================================================

echo -e "${YELLOW}ðŸ“ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ IDE Ñ„Ð°Ð¹Ð»Ð¾Ð²...${NC}"

rm -rf .idea/
rm -rf screenshots/

echo -e "${GREEN}  âœ“ IDE Ñ„Ð°Ð¹Ð»Ñ‹ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹${NC}\n"


# ============================================================================
# 8. Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ð¼ .gitignore ÐµÑÐ»Ð¸ Ð½ÐµÑ‚
# ============================================================================

echo -e "${YELLOW}ðŸ“ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ .gitignore...${NC}"

cat > .gitignore << 'EOF'
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
*.egg-info/
dist/
build/

# Virtual Environment
venv/
.venv/
env/
ENV/

# Environment variables
.env

# IDE
.idea/
.vscode/
*.swp
*.swo
*~

# Logs
logs/*.log
logs/*.png
*.log

# Charts
charts/*.png

# Cache
.pytest_cache/
.coverage
*.cache

# OS
.DS_Store
Thumbs.db

# Project specific
data/.pairs_cache.txt
EOF

echo -e "${GREEN}  âœ“ .gitignore Ð¾Ð±Ð½Ð¾Ð²Ð»Ñ‘Ð½${NC}\n"


# ============================================================================
# Ð˜Ñ‚Ð¾Ð³Ð¸
# ============================================================================

echo -e "${GREEN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo -e "${GREEN}âœ… ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°!${NC}"
echo -e "${GREEN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\n"

echo "Ð£Ð´Ð°Ð»ÐµÐ½Ð¾:"
echo "  â€¢ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Python Ñ„Ð°Ð¹Ð»Ñ‹ (main.py, ws_main.py, etc.)"
echo "  â€¢ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹"
echo "  â€¢ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ð¼Ð¾Ð´ÑƒÐ»Ð¸"
echo "  â€¢ Ð¢ÐµÑÑ‚Ñ‹"
echo "  â€¢ Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸"
echo "  â€¢ Python ÐºÑÑˆ"
echo "  â€¢ IDE Ñ„Ð°Ð¹Ð»Ñ‹"
echo ""
echo "Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ñ‡Ð¸ÑÑ‚Ð°Ñ Ð¸ Ð³Ð¾Ñ‚Ð¾Ð²Ð° Ð´Ð»Ñ production!"
